{{!-- Action Type --}}
<div class="form-group select">
    <label>{{ localize "DND5E.ItemActionType" }}</label>
    <select name="system.usageProfiles.{{system.usageProfileIndex}}.actionType">
        {{#select (getProperty (lookup system.usageProfiles system.usageProfileIndex) "actionType")}}
        <option value=""></option>
        {{#each config.itemActionTypes as |name type|}}
        <option value="{{type}}">{{name}}</option>
        {{/each}}
        {{/select}}
    </select>
</div>

{{!-- Hides every subsequent field if there's no Action Type --}}
{{#if (getProperty (lookup system.usageProfiles system.usageProfileIndex) "actionType")}}

{{!-- Ability Modifier --}}
<div class="form-group select">
    <label>{{ localize "DND5E.AbilityModifier" }}</label>
    <select name="system.usageProfiles.{{system.usageProfileIndex}}.ability">
        {{#select (getProperty (lookup system.usageProfiles system.usageProfileIndex) "ability")}}
        <option value="">{{ localize "DND5E.Default" }}</option>
        {{#each config.abilities as |ability a|}}
        <option value="{{a}}">{{ability}}</option>
        {{/each}}
        {{/select}}
    </select>
</div>

{{!-- Attack Roll Bonus --}}
{{#if hasAttackRoll }}
<div class="form-group">
    <label>{{ localize "DND5E.ItemAttackBonus" }}</label>
    <div class="form-fields">
        <input type="text" name="system.usageProfiles.{{system.usageProfileIndex}}.attackBonus" value="{{ getProperty (lookup system.usageProfiles system.usageProfileIndex) "attackBonus" }}"/>
    </div>
</div>
{{/if}}

{{!-- Critical Hit Threshold --}}
{{#if hasAttackRoll }}
<div class="form-group">
    <label>{{ localize "DND5E.ItemCritThreshold" }}</label>
    <div class="form-fields">
        {{ numberInput (getProperty (lookup system.usageProfiles system.usageProfileIndex) "critical.threshold") name="system.usageProfiles.{{system.usageProfileIndex}}.critical.threshold" placeholder="20" max=20 min=1 step=1 }}
    </div>
</div>
{{/if}}

{{!-- Critical Hit Damage --}}
{{#if hasAttackRoll }}
<div class="form-group">
    <label>{{ localize "DND5E.ItemCritExtraDamage" }}</label>
    <div class="form-fields">
        <input type="text" name="system.usageProfiles.{{system.usageProfileIndex}}.critical.damage" value="{{ getProperty (lookup system.usageProfiles system.usageProfileIndex) "critical.damage" }}">
    </div>
</div>
{{/if}}

{{!-- Damage Formula --}}
<h4 class="damage-header">
    {{#unless isHealing }}{{ localize "DND5E.Damage" }}{{ else }}{{ localize "DND5E.Healing" }}{{/unless}} {{ localize "DND5E.Formula" }}
    {{#if editable}}<a class="damage-control add-damage"><i class="fas fa-plus"></i></a>{{/if}}
</h4>
<ol class="damage-parts form-group">
    {{#each (getProperty (lookup system.usageProfiles system.usageProfileIndex) "damage.parts") as |part i| }}
    <li class="damage-part flexrow" data-damage-part="{{i}}">
        <input type="text" name="system.usageProfiles.{{../system.usageProfileIndex}}.damage.parts.{{i}}.0" value="{{lookup this "0"}}"/>
        <select name="system.usageProfiles.{{../system.usageProfileIndex}}.damage.parts.{{i}}.1">
            {{#select (lookup this "1") }}
            <option value="">{{ localize "DND5E.None" }}</option>
            {{#each ../config.damageTypes as |name type|}}
            <option value="{{type}}">{{name}}</option>
            {{/each}}
            {{#each ../config.healingTypes as |name type|}}
            <option value="{{type}}">{{name}}</option>
            {{/each}}
            {{/select}}
        </select>
        {{#if ../editable}}<a class="damage-control delete-damage"><i class="fas fa-minus"></i></a>{{/if}}
    </li>
    {{/each}}
</ol>

{{!-- Other Formula --}}
<div class="form-group">
    <label>{{ localize "DND5E.OtherFormula" }}</label>
    <div class="form-fields">
        <input type="text" name="system.usageProfiles.{{system.usageProfileIndex}}.formula" value="{{ getProperty (lookup system.usageProfiles system.usageProfileIndex) "formula" }}" placeholder="{{ localize 'DND5E.Formula' }}"/>
    </div>
</div>

{{!-- Saving Throw --}}
<div class="form-group input-select">
    <label>{{ localize "DND5E.ActionSave" }}</label>
    <div class="form-fields">
        <select name="system.usageProfiles.{{system.usageProfileIndex}}.save.ability">
            {{#select (getProperty (lookup system.usageProfiles system.usageProfileIndex) "save.ability")}}
            <option value=""></option>
            {{#each config.abilities as |ability a|}}
            <option value="{{a}}">{{ability}}</option>
            {{/each}}
            {{/select}}
        </select>
        <span>{{ localize "DND5E.VsDC" }}</span>
        <input type="number" step="any" name="system.usageProfiles.{{system.usageProfileIndex}}.save.dc"
            value="{{#if (getProperty (lookup system.usageProfiles system.usageProfileIndex) "save.dc")}}{{ getProperty (lookup system.usageProfiles system.usageProfileIndex) "save.dc" }}{{/if}}"
            placeholder="{{ localize 'DND5E.AbbreviationDC' }}" {{#unless isFlatDC}}disabled{{/unless}}>
        <select name="system.usageProfiles.{{system.usageProfileIndex}}.save.scaling">
            {{#select (getProperty (lookup system.usageProfiles system.usageProfileIndex) "save.scaling")}}
            <option value="spell">{{ localize "DND5E.Spellcasting" }}</option>
            {{#each config.abilities as |ability a|}}
            <option value="{{a}}">{{ability}}</option>
            {{/each}}
            <option value="flat">{{ localize "DND5E.Flat" }}</option>
            {{/select}}
        </select>
    </div>
</div>

{{!-- Chat Message Flavor --}}
<div class="form-group stacked">
    <label>{{ localize "DND5E.ChatFlavor" }}</label>
    <input type="text" name="system.usageProfiles.{{system.usageProfileIndex}}.chatFlavor" value="{{ getProperty (lookup system.usageProfiles system.usageProfileIndex) "chatFlavor" }}"/>
</div>

{{/if}}